class P{constructor(i,o){this.element=i,this.touch1=null,this.touch2=null,this.touchStartX=null,this.touchStartY=null,this.touchEndX=null,this.touchEndY=null,this.touchMove1=null,this.touchMove2=null,this.touchMoveX=null,this.touchMoveY=null,this.velocityX=null,this.velocityY=null,this.longPressTimer=null,this.doubleTapTimer=null,this.doubleTapWaiting=!1,this.thresholdX=0,this.thresholdY=0,this.disregardVelocityThresholdX=0,this.disregardVelocityThresholdY=0,this.swipingHorizontal=!1,this.swipingVertical=!1,this.swipingDirection=null,this.swipedHorizontal=!1,this.swipedVertical=!1,this.originalDistance=null,this.newDistance=null,this.scale=null,this.originalAngle=null,this.newAngle=null,this.rotation=null,this.handlers={panstart:[],panmove:[],panend:[],swipeleft:[],swiperight:[],swipeup:[],swipedown:[],tap:[],doubletap:[],longpress:[],pinch:[],pinchend:[],rotate:[],rotateend:[]},this._onTouchStart=this.onTouchStart.bind(this),this._onTouchMove=this.onTouchMove.bind(this),this._onTouchEnd=this.onTouchEnd.bind(this),this.opts=Object.assign({},P.defaults,o),this.element.addEventListener("touchstart",this._onTouchStart,M),this.element.addEventListener("touchmove",this._onTouchMove,M),this.element.addEventListener("touchend",this._onTouchEnd,M),this.opts.mouseSupport&&!("ontouchstart"in window)&&(this.element.addEventListener("mousedown",this._onTouchStart,M),document.addEventListener("mousemove",this._onTouchMove,M),document.addEventListener("mouseup",this._onTouchEnd,M))}destroy(){var i,o;this.element.removeEventListener("touchstart",this._onTouchStart),this.element.removeEventListener("touchmove",this._onTouchMove),this.element.removeEventListener("touchend",this._onTouchEnd),this.element.removeEventListener("mousedown",this._onTouchStart),document.removeEventListener("mousemove",this._onTouchMove),document.removeEventListener("mouseup",this._onTouchEnd),clearTimeout((i=this.longPressTimer)!==null&&i!==void 0?i:void 0),clearTimeout((o=this.doubleTapTimer)!==null&&o!==void 0?o:void 0)}on(i,o){if(this.handlers[i])return this.handlers[i].push(o),{type:i,fn:o,cancel:()=>this.off(i,o)}}off(i,o){if(this.handlers[i]){const e=this.handlers[i].indexOf(o);e!==-1&&this.handlers[i].splice(e,1)}}fire(i,o){for(let e=0;e<this.handlers[i].length;e++)this.handlers[i][e](o)}onTouchStart(i){var o,e,r,c,a,v,p,f,m,T,n,h,t,l,d,u,s,g,_,Y,y,b,E,S,V,L;let w=!1;if(i.type!=="mousedown"){if(this.touch1||(this.touch1=i.changedTouches[0],w=!0),(w&&i.changedTouches.length>1||!w)&&!this.touch2){this.touch2=[...i.changedTouches].find(x=>{var D;return x.identifier!==((D=this.touch1)===null||D===void 0?void 0:D.identifier)})||null,this.originalDistance=Math.sqrt(Math.pow(((e=(o=this.touch2)===null||o===void 0?void 0:o.screenX)!==null&&e!==void 0?e:0)-((v=(c=(r=this.touchMove1)===null||r===void 0?void 0:r.screenX)!==null&&c!==void 0?c:(a=this.touch1)===null||a===void 0?void 0:a.screenX)!==null&&v!==void 0?v:0),2)+Math.pow(((f=(p=this.touch2)===null||p===void 0?void 0:p.screenY)!==null&&f!==void 0?f:0)-((h=(T=(m=this.touchMove1)===null||m===void 0?void 0:m.screenY)!==null&&T!==void 0?T:(n=this.touch1)===null||n===void 0?void 0:n.screenY)!==null&&h!==void 0?h:0),2)),this.originalAngle=Math.atan2(((l=(t=this.touch2)===null||t===void 0?void 0:t.screenY)!==null&&l!==void 0?l:0)-((g=(u=(d=this.touchMove1)===null||d===void 0?void 0:d.screenY)!==null&&u!==void 0?u:(s=this.touch1)===null||s===void 0?void 0:s.screenY)!==null&&g!==void 0?g:0),((Y=(_=this.touch2)===null||_===void 0?void 0:_.screenX)!==null&&Y!==void 0?Y:0)-((S=(b=(y=this.touchMove1)===null||y===void 0?void 0:y.screenX)!==null&&b!==void 0?b:(E=this.touch1)===null||E===void 0?void 0:E.screenX)!==null&&S!==void 0?S:0))/(Math.PI/180);return}if(!w)return}(w||i.type==="mousedown")&&(this.thresholdX=this.opts.threshold("x",this),this.thresholdY=this.opts.threshold("y",this),this.disregardVelocityThresholdX=this.opts.disregardVelocityThreshold("x",this),this.disregardVelocityThresholdY=this.opts.disregardVelocityThreshold("y",this),this.touchStartX=i.type==="mousedown"?i.screenX:((V=this.touch1)===null||V===void 0?void 0:V.screenX)||0,this.touchStartY=i.type==="mousedown"?i.screenY:((L=this.touch1)===null||L===void 0?void 0:L.screenY)||0,this.touchMoveX=null,this.touchMoveY=null,this.touchEndX=null,this.touchEndY=null,this.swipingDirection=null,this.longPressTimer=setTimeout(()=>this.fire("longpress",i),this.opts.longPressTime),this.scale=1,this.rotation=0,this.fire("panstart",i))}onTouchMove(i){var o,e,r,c,a,v,p,f,m,T,n,h,t;if(i.type==="mousemove"&&(!this.touchStartX||this.touchEndX!==null))return;let l,d;if(i.type!=="mousemove"&&(l=[...i.changedTouches].find(u=>{var s;return u.identifier===((s=this.touch1)===null||s===void 0?void 0:s.identifier)}),this.touchMove1=l||this.touchMove1,d=[...i.changedTouches].find(u=>{var s;return u.identifier===((s=this.touch2)===null||s===void 0?void 0:s.identifier)}),this.touchMove2=d||this.touchMove2),i.type==="mousemove"||l){const u=(i.type==="mousemove"?i.screenX:(o=l==null?void 0:l.screenX)!==null&&o!==void 0?o:0)-((e=this.touchStartX)!==null&&e!==void 0?e:0);this.velocityX=u-((r=this.touchMoveX)!==null&&r!==void 0?r:0),this.touchMoveX=u;const s=(i.type==="mousemove"?i.screenY:(c=l==null?void 0:l.screenY)!==null&&c!==void 0?c:0)-((a=this.touchStartY)!==null&&a!==void 0?a:0);this.velocityY=s-((v=this.touchMoveY)!==null&&v!==void 0?v:0),this.touchMoveY=s;const g=Math.abs(this.touchMoveX),_=Math.abs(this.touchMoveY);this.swipingHorizontal=g>this.thresholdX,this.swipingVertical=_>this.thresholdY,this.swipingDirection=g>_?this.swipingHorizontal?"horizontal":"pre-horizontal":this.swipingVertical?"vertical":"pre-vertical",Math.max(g,_)>this.opts.pressThreshold&&clearTimeout((p=this.longPressTimer)!==null&&p!==void 0?p:void 0),this.fire("panmove",i)}i.type!=="mousemove"&&this.touchMove1!=null&&this.touchMove2!=null&&(this.newDistance=Math.sqrt(Math.pow(this.touchMove2.screenX-this.touchMove1.screenX,2)+Math.pow(this.touchMove2.screenY-this.touchMove1.screenY,2)),this.scale=this.newDistance/((f=this.originalDistance)!==null&&f!==void 0?f:0),this.fire("pinch",i),this.newAngle=Math.atan2(((m=this.touchMove2.screenY)!==null&&m!==void 0?m:0)-((T=this.touchMove1.screenY)!==null&&T!==void 0?T:0),((n=this.touchMove2.screenX)!==null&&n!==void 0?n:0)-((h=this.touchMove1.screenX)!==null&&h!==void 0?h:0))/(Math.PI/180),this.rotation=this.newAngle-((t=this.originalAngle)!==null&&t!==void 0?t:0),this.fire("rotate",i))}onTouchEnd(i){var o,e,r,c,a,v,p,f,m,T;let n;if(i.type!=="mouseup"&&(n=[...i.changedTouches].find(h=>{var t;return h.identifier===((t=this.touch1)===null||t===void 0?void 0:t.identifier)}),[...i.touches].find(h=>{var t;return h.identifier===((t=this.touch1)===null||t===void 0?void 0:t.identifier)})||(this.touch1=null,this.touchMove1=null),[...i.touches].find(h=>{var t;return h.identifier===((t=this.touch2)===null||t===void 0?void 0:t.identifier)})||(this.touch2=null,this.touchMove2=null)),!(i.type==="mouseup"&&(!this.touchStartX||this.touchEndX!==null))){if(i.type==="mouseup"||n){this.touchEndX=i.type==="mouseup"?i.screenX:(o=n==null?void 0:n.screenX)!==null&&o!==void 0?o:0,this.touchEndY=i.type==="mouseup"?i.screenY:(e=n==null?void 0:n.screenY)!==null&&e!==void 0?e:0,this.fire("panend",i),clearTimeout((r=this.longPressTimer)!==null&&r!==void 0?r:void 0);const h=this.touchEndX-((c=this.touchStartX)!==null&&c!==void 0?c:0),t=Math.abs(h),l=this.touchEndY-((a=this.touchStartY)!==null&&a!==void 0?a:0),d=Math.abs(l),u=Math.sqrt(Math.pow(h,2)+Math.pow(l,2)),s=Math.abs(u),g=d/t;t>this.thresholdX||d>this.thresholdY||this.opts.diagonalSwipes&&(s>this.thresholdX||s>this.thresholdY)?(this.swipedHorizontal=t>this.thresholdX||this.opts.diagonalSwipes&&s>this.thresholdX,this.swipedVertical=d>this.thresholdY||this.opts.diagonalSwipes&&s>this.thresholdY,(!this.opts.diagonalSwipes||g<Math.tan((45-this.opts.diagonalLimit)*Math.PI/180)||g>Math.tan((45+this.opts.diagonalLimit)*Math.PI/180))&&(t>=d&&(this.swipedVertical=!1),d>t&&(this.swipedHorizontal=!1)),this.swipedHorizontal&&(h<0?(((v=this.velocityX)!==null&&v!==void 0?v:0)<-this.opts.velocityThreshold||u<-this.disregardVelocityThresholdX)&&this.fire("swipeleft",i):(((p=this.velocityX)!==null&&p!==void 0?p:0)>this.opts.velocityThreshold||u>this.disregardVelocityThresholdX)&&this.fire("swiperight",i)),this.swipedVertical&&(l<0?(((f=this.velocityY)!==null&&f!==void 0?f:0)<-this.opts.velocityThreshold||u<-this.disregardVelocityThresholdY)&&this.fire("swipeup",i):(((m=this.velocityY)!==null&&m!==void 0?m:0)>this.opts.velocityThreshold||u>this.disregardVelocityThresholdY)&&this.fire("swipedown",i))):t<this.opts.pressThreshold&&d<this.opts.pressThreshold&&(this.doubleTapWaiting?(this.doubleTapWaiting=!1,clearTimeout((T=this.doubleTapTimer)!==null&&T!==void 0?T:void 0),this.fire("doubletap",i)):(this.doubleTapWaiting=!0,this.doubleTapTimer=setTimeout(()=>this.doubleTapWaiting=!1,this.opts.doubleTapTime),this.fire("tap",i)))}!this.touch1&&!this.touch2&&(this.fire("pinchend",i),this.fire("rotateend",i),this.originalDistance=null,this.newDistance=null,this.scale=null,this.originalAngle=null,this.newAngle=null,this.rotation=null)}}}P.defaults={threshold:(X,i)=>Math.max(25,Math.floor(.15*(X==="x"?window.innerWidth||document.body.clientWidth:window.innerHeight||document.body.clientHeight))),velocityThreshold:10,disregardVelocityThreshold:(X,i)=>Math.floor(.5*(X==="x"?i.element.clientWidth:i.element.clientHeight)),pressThreshold:8,diagonalSwipes:!1,diagonalLimit:15,longPressTime:500,doubleTapTime:300,mouseSupport:!0};let M=!1;try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){M={passive:!0}}}))}catch{}export{P as T};
